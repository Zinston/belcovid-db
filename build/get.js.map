{"version":3,"sources":["../src/get.js"],"names":["db","key","fromId","collection","cursor","find","toArray","allDiffs","index","findIndex","singleDiff","diffId","startDiff","endDiff","length","result","start","datetime","end","changes","slice","flatMap","diff","getDiff"],"mappings":";;;;;;;uEAAO,iBAAuBA,EAAvB,EAA2BC,GAA3B,EAAgCC,MAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AACGC,kCADH,GACgBH,GAAGG,UAAH,CAAcF,GAAd,CADhB;AAEGG,8BAFH,GAEYD,WAAWE,IAAX,EAFZ;AAGH;;AAHG;AAAA,+BAIoBD,OAAOE,OAAP,EAJpB;;AAAA;AAIGC,gCAJH;AAKGC,6BALH,GAKWN,SAASK,SAASE,SAAT,CAAmB;AAAA,mCAAcC,WAAWC,MAAX,KAAsBT,MAApC;AAAA,yBAAnB,CAAT,GAA0E,CALrF;AAMGU,iCANH,GAMeL,SAASC,KAAT,CANf;AAOGK,+BAPH,GAOaN,SAASA,SAASO,MAAT,GAAkB,CAA3B,CAPb;AASGC,8BATH,GASY;AACXC,mCAAO,CAACJ,UAAUD,MAAX,EAAmBC,UAAUK,QAA7B,CADI;AAEXC,iCAAK,CAACL,QAAQF,MAAT,EAAiBE,QAAQI,QAAzB,CAFM;AAGXE,qCAASZ,SAASa,KAAT,CAAeZ,QAAQ,CAAvB,EAA0Ba,OAA1B,CAAkC;AAAA,uCAAQC,KAAKH,OAAb;AAAA,6BAAlC;AAHE,yBATZ;AAAA,yDAcIJ,MAdJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;oBAAeQ,O","file":"get.js","sourcesContent":["export async function getDiff(db, key, fromId) {\n    const collection = db.collection(key);\n    const cursor = collection.find();\n    // Get all diffs until ID.\n    const allDiffs = await cursor.toArray();\n    const index = fromId ? allDiffs.findIndex(singleDiff => singleDiff.diffId === fromId) : 0;\n    const startDiff = allDiffs[index];\n    const endDiff = allDiffs[allDiffs.length - 1];\n\n    const result = {\n        start: [startDiff.diffId, startDiff.datetime],\n        end: [endDiff.diffId, endDiff.datetime],\n        changes: allDiffs.slice(index + 1).flatMap(diff => diff.changes),\n    };\n    return result;\n}\n"]}